<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸ” Search Functionality Test - Skippy AI</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        line-height: 1.6;
      }
      .container {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
      }
      .section {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .test-btn {
        background: linear-gradient(45deg, #4caf50, #45a049);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        cursor: pointer;
        font-size: 16px;
        margin: 10px 5px;
        transition: all 0.3s ease;
      }
      .test-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
      }
      .test-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }
      .result-area {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
        min-height: 200px;
        font-family: "Courier New", monospace;
        white-space: pre-wrap;
        max-height: 500px;
        overflow-y: auto;
      }
      .status {
        padding: 10px;
        border-radius: 5px;
        margin: 10px 0;
      }
      .status.success {
        background: rgba(76, 175, 80, 0.3);
      }
      .status.error {
        background: rgba(244, 67, 54, 0.3);
      }
      .status.warning {
        background: rgba(255, 193, 7, 0.3);
      }
      .status.info {
        background: rgba(33, 150, 243, 0.3);
      }
      h1 {
        text-align: center;
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ” Search Functionality Test</h1>
      <p style="text-align: center; font-size: 1.1em; opacity: 0.9">
        Comprehensive testing for Skippy AI's enhanced search capabilities
      </p>

      <!-- Setup Section -->
      <div class="section">
        <h2>ğŸš€ Setup & Preparation</h2>
        <p>Before testing search, let's set up some sample data:</p>
        <button class="test-btn" onclick="setupSampleData()">
          ğŸ“Š Add Sample Data
        </button>
        <button class="test-btn" onclick="checkCurrentData()">
          ğŸ“‹ Check Current Data
        </button>
        <button class="test-btn" onclick="clearAllData()">
          ğŸ—‘ï¸ Clear All Data
        </button>
      </div>

      <!-- Search Tests Section -->
      <div class="section">
        <h2>ğŸ” Search Tests</h2>
        <p>Test different search scenarios:</p>

        <h3>Programming Content Searches:</h3>
        <button
          class="test-btn"
          onclick="testSearch('find all my programming materials')"
        >
          ğŸ” Find Programming Materials
        </button>
        <button
          class="test-btn"
          onclick="testSearch('what notes do I have about JavaScript')"
        >
          ğŸ“ JavaScript Notes
        </button>
        <button
          class="test-btn"
          onclick="testSearch('search for Python content')"
        >
          ğŸ Python Content
        </button>

        <h3>AI & Technology Searches:</h3>
        <button class="test-btn" onclick="testSearch('find AI flashcards')">
          ğŸ¤– AI Flashcards
        </button>
        <button
          class="test-btn"
          onclick="testSearch('show me machine learning notes')"
        >
          ğŸ§  ML Notes
        </button>

        <h3>Schedule Searches:</h3>
        <button
          class="test-btn"
          onclick="testSearch('what study sessions do I have')"
        >
          ğŸ“… Study Sessions
        </button>
        <button
          class="test-btn"
          onclick="testSearch('show my programming schedule')"
        >
          â° Programming Schedule
        </button>

        <h3>General Searches:</h3>
        <button
          class="test-btn"
          onclick="testSearch('find everything about programming')"
        >
          ğŸ” Everything Programming
        </button>
        <button
          class="test-btn"
          onclick="testSearch('search my study materials')"
        >
          ğŸ“š All Study Materials
        </button>
      </div>

      <!-- Custom Search Section -->
      <div class="section">
        <h2>âœï¸ Custom Search Test</h2>
        <p>Enter your own search query:</p>
        <input
          type="text"
          id="customSearch"
          placeholder="e.g., find notes about algorithms"
          style="
            width: 70%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            margin-right: 10px;
          "
        />
        <button class="test-btn" onclick="testCustomSearch()">
          ğŸ” Test Search
        </button>
      </div>

      <!-- Status Display -->
      <div class="section">
        <h2>ğŸ“Š Test Status</h2>
        <div id="status" class="status info">
          Ready to test! Click setup buttons above to begin.
        </div>
      </div>

      <!-- Results Display -->
      <div class="section">
        <h2>ğŸ“‹ Test Results</h2>
        <div class="result-area" id="results">
          Welcome to the Search Functionality Test! ğŸ“ Instructions: 1. First,
          click "Add Sample Data" to create test content 2. Then try any of the
          search test buttons 3. Check the results below 4. Try custom searches
          in the input field ğŸ¯ What we're testing: â€¢ Enhanced search across
          notes, flashcards, and schedule â€¢ Content preview and suggestions â€¢
          Intelligent result filtering â€¢ Error handling and user feedback
        </div>
      </div>
    </div>

    <script>
      let isSearchReady = false;

      // Check if universalAI is available
      function checkSearchAvailability() {
        if (typeof universalAI !== "undefined") {
          setStatus("âœ… Search system ready!", "success");
          isSearchReady = true;
          return true;
        } else {
          setStatus(
            "âš ï¸ UniversalAI not found. Please open your Skippy AI app first.",
            "warning"
          );
          isSearchReady = false;
          return false;
        }
      }

      // Set status message
      function setStatus(message, type = "info") {
        const statusEl = document.getElementById("status");
        statusEl.textContent = message;
        statusEl.className = `status ${type}`;
      }

      // Update results
      function updateResults(content) {
        const resultsEl = document.getElementById("results");
        resultsEl.textContent = content;
      }

      // Setup sample data
      function setupSampleData() {
        setStatus("ğŸ“Š Adding sample data...", "info");

        const sampleNotes = [
          {
            id: "note-js-1",
            title: "JavaScript Fundamentals",
            content:
              "JavaScript is a programming language that enables interactive web pages. Key concepts include variables, functions, objects, and event handling.",
            category: "programming",
            tags: ["javascript", "web development", "programming"],
            createdAt: new Date().toISOString(),
            source: "Manual",
          },
          {
            id: "note-ai-1",
            title: "Artificial Intelligence Basics",
            content:
              "AI is the simulation of human intelligence in machines. Machine learning is a subset of AI that enables computers to learn without being explicitly programmed.",
            category: "ai",
            tags: [
              "artificial intelligence",
              "machine learning",
              "programming",
            ],
            createdAt: new Date().toISOString(),
            source: "Manual",
          },
          {
            id: "note-python-1",
            title: "Python Programming",
            content:
              "Python is a high-level programming language known for its simplicity and readability. It is widely used in data science, web development, and automation.",
            category: "programming",
            tags: ["python", "programming", "data science"],
            createdAt: new Date().toISOString(),
            source: "Manual",
          },
        ];

        const sampleFlashcards = [
          {
            id: "card-js-1",
            question: "What is JavaScript?",
            answer:
              "JavaScript is a programming language that enables interactive web pages and is commonly used for client-side web development.",
            category: "programming",
            createdAt: new Date().toISOString(),
          },
          {
            id: "card-ai-1",
            question: "What is Machine Learning?",
            answer:
              "Machine Learning is a subset of AI that enables computers to learn and improve from experience without being explicitly programmed.",
            category: "ai",
            createdAt: new Date().toISOString(),
          },
          {
            id: "card-python-1",
            question: "What makes Python popular?",
            answer:
              "Python is popular due to its simple syntax, readability, extensive libraries, and versatility in various domains.",
            category: "programming",
            createdAt: new Date().toISOString(),
          },
        ];

        const sampleSchedule = [
          {
            id: "schedule-1",
            title: "JavaScript Study Session",
            date: new Date(Date.now() + 24 * 60 * 60 * 1000)
              .toISOString()
              .split("T")[0],
            time: "10:00",
            type: "study",
            priority: "high",
          },
          {
            id: "schedule-2",
            title: "Python Programming Practice",
            date: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000)
              .toISOString()
              .split("T")[0],
            time: "14:00",
            type: "study",
            priority: "medium",
          },
        ];

        try {
          // Get existing data and merge
          const existingNotes = JSON.parse(
            localStorage.getItem("skippy-notes") || "[]"
          );
          const existingFlashcards = JSON.parse(
            localStorage.getItem("skippy-flashcards") || "[]"
          );
          const existingSchedule = JSON.parse(
            localStorage.getItem("skippy-schedule") || "[]"
          );

          // Add sample data (avoid duplicates)
          const mergedNotes = [...existingNotes];
          sampleNotes.forEach((note) => {
            if (!existingNotes.find((n) => n.title === note.title)) {
              mergedNotes.push(note);
            }
          });

          const mergedFlashcards = [...existingFlashcards];
          sampleFlashcards.forEach((card) => {
            if (!existingFlashcards.find((c) => c.question === card.question)) {
              mergedFlashcards.push(card);
            }
          });

          const mergedSchedule = [...existingSchedule];
          sampleSchedule.forEach((item) => {
            if (!existingSchedule.find((s) => s.title === item.title)) {
              mergedSchedule.push(item);
            }
          });

          localStorage.setItem("skippy-notes", JSON.stringify(mergedNotes));
          localStorage.setItem(
            "skippy-flashcards",
            JSON.stringify(mergedFlashcards)
          );
          localStorage.setItem(
            "skippy-schedule",
            JSON.stringify(mergedSchedule)
          );

          setStatus("âœ… Sample data added successfully!", "success");
          updateResults(`ğŸ“Š SAMPLE DATA ADDED SUCCESSFULLY!
                
ğŸ“ Total Notes: ${mergedNotes.length}
ğŸ´ Total Flashcards: ${mergedFlashcards.length}
ğŸ“… Total Schedule Items: ${mergedSchedule.length}

ğŸ¯ Ready to test search! Try the search buttons above.`);
        } catch (error) {
          setStatus("âŒ Error adding sample data: " + error.message, "error");
        }
      }

      // Check current data
      function checkCurrentData() {
        try {
          const notes = JSON.parse(
            localStorage.getItem("skippy-notes") || "[]"
          );
          const flashcards = JSON.parse(
            localStorage.getItem("skippy-flashcards") || "[]"
          );
          const schedule = JSON.parse(
            localStorage.getItem("skippy-schedule") || "[]"
          );

          let output = `ğŸ“Š YOUR CURRENT STUDY DATA
=================================

ğŸ“ NOTES (${notes.length} found):
`;
          if (notes.length > 0) {
            notes.slice(0, 5).forEach((note, i) => {
              output += `${i + 1}. ${note.title || "Untitled"} - ${
                note.category || "No category"
              }
   ${(note.content || "").substring(0, 80)}...

`;
            });
          } else {
            output +=
              '   No notes found. Click "Add Sample Data" to create test content.\n\n';
          }

          output += `ğŸ´ FLASHCARDS (${flashcards.length} found):
`;
          if (flashcards.length > 0) {
            flashcards.slice(0, 3).forEach((card, i) => {
              output += `${i + 1}. Q: ${card.question || "No question"}
   A: ${(card.answer || "").substring(0, 60)}...

`;
            });
          } else {
            output +=
              '   No flashcards found. Click "Add Sample Data" to create test content.\n\n';
          }

          output += `ğŸ“… SCHEDULE (${schedule.length} found):
`;
          if (schedule.length > 0) {
            schedule.slice(0, 3).forEach((item, i) => {
              output += `${i + 1}. ${item.title} - ${item.date} ${
                item.time || ""
              }

`;
            });
          } else {
            output +=
              '   No schedule items found. Click "Add Sample Data" to create test content.\n\n';
          }

          updateResults(output);
          setStatus(
            `ğŸ“Š Data check complete: ${
              notes.length + flashcards.length + schedule.length
            } total items`,
            "info"
          );
        } catch (error) {
          setStatus("âŒ Error checking data: " + error.message, "error");
        }
      }

      // Clear all data
      function clearAllData() {
        if (
          confirm(
            "Are you sure you want to clear all study data? This cannot be undone."
          )
        ) {
          localStorage.removeItem("skippy-notes");
          localStorage.removeItem("skippy-flashcards");
          localStorage.removeItem("skippy-schedule");
          localStorage.removeItem("buddy-memory");

          setStatus("âœ… All data cleared!", "success");
          updateResults(
            "ğŸ—‘ï¸ All study data has been cleared.\n\nYou can now add sample data and test search functionality."
          );
        }
      }

      // Test search with specific query
      function testSearch(query) {
        if (!checkSearchAvailability()) {
          updateResults(
            "âŒ Cannot test search - UniversalAI not available.\n\nPlease:\n1. Open your Skippy AI app (http://localhost:8081)\n2. Wait for it to load completely\n3. Then come back to this test page"
          );
          return;
        }

        setStatus(`ğŸ” Testing search: "${query}"`, "info");
        updateResults(`ğŸ” TESTING SEARCH: "${query}"
==================================

â³ Processing search request...
Please wait for results...`);

        try {
          universalAI
            .processAnyPrompt({ text: query })
            .then((result) => {
              setStatus("âœ… Search completed successfully!", "success");

              let output = `ğŸ” SEARCH RESULTS FOR: "${query}"
${"=".repeat(50)}

ğŸ“‹ SUMMARY:
${result.summary || "No summary provided"}

`;

              if (result.artifacts) {
                if (
                  result.artifacts.notes &&
                  result.artifacts.notes.length > 0
                ) {
                  output += `ğŸ“ NOTES FOUND (${result.artifacts.notes.length}):
`;
                  result.artifacts.notes.forEach((note, i) => {
                    output += `${i + 1}. ${note.title || "Untitled"}
   Category: ${note.category || "No category"}
   Preview: ${(note.content || "").substring(0, 100)}...

`;
                  });
                }

                if (
                  result.artifacts.flashcards &&
                  result.artifacts.flashcards.length > 0
                ) {
                  output += `ğŸ´ FLASHCARDS FOUND (${result.artifacts.flashcards.length}):
`;
                  result.artifacts.flashcards.forEach((card, i) => {
                    output += `${i + 1}. Q: ${card.question || "No question"}
   A: ${(card.answer || "").substring(0, 80)}...

`;
                  });
                }

                if (
                  result.artifacts.schedule &&
                  result.artifacts.schedule.length > 0
                ) {
                  output += `ğŸ“… SCHEDULE ITEMS FOUND (${result.artifacts.schedule.length}):
`;
                  result.artifacts.schedule.forEach((item, i) => {
                    output += `${i + 1}. ${item.title} - ${item.date} ${
                      item.time || ""
                    }

`;
                  });
                }
              }

              output += `
ğŸ¯ SEARCH TEST RESULT: âœ… SUCCESS
The enhanced search functionality is working correctly!`;

              updateResults(output);
            })
            .catch((error) => {
              setStatus("âŒ Search failed: " + error.message, "error");
              updateResults(`âŒ SEARCH FAILED
=================

Query: "${query}"
Error: ${error.message}

ğŸ”§ Troubleshooting:
1. Make sure you have sample data (click "Add Sample Data")
2. Check that you're on the Skippy AI page
3. Verify the universalAI is loaded
4. Try refreshing both pages`);
            });
        } catch (error) {
          setStatus("âŒ Search error: " + error.message, "error");
          updateResults(`âŒ SEARCH ERROR: ${error.message}`);
        }
      }

      // Test custom search
      function testCustomSearch() {
        const query = document.getElementById("customSearch").value.trim();
        if (!query) {
          setStatus("âš ï¸ Please enter a search query", "warning");
          return;
        }
        testSearch(query);
      }

      // Handle Enter key in search input
      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("customSearch")
          .addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              testCustomSearch();
            }
          });

        // Initial check
        checkSearchAvailability();
      });
    </script>
  </body>
</html>
